
## üß† –í–≤–æ–¥–Ω–æ–µ –∑–∞–Ω—è—Ç–∏–µ –ø–æ Keras (TensorFlow) –≤ Google Colab

**–¢–µ–º–∞:** –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π

---

### üìå –ß—Ç–æ —Ç–∞–∫–æ–µ Keras?

[Keras](https://keras.io/) ‚Äî —ç—Ç–æ –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π API –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏ –æ–±—É—á–µ–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π. –û–Ω –≤—Å—Ç—Ä–æ–µ–Ω –≤ `TensorFlow` –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –º–æ–¥–µ–ª–∏ –¥–ª—è –∑–∞–¥–∞—á –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

---

## 1Ô∏è‚É£ –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ TensorFlow

```python
# TensorFlow —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Google Colab, –Ω–æ –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π:
!pip install -q tensorflow

# –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫
import tensorflow as tf
from tensorflow import keras
import numpy as np
import matplotlib.pyplot as plt

print("–í–µ—Ä—Å–∏—è TensorFlow:", tf.__version__)
```

---

## 2Ô∏è‚É£ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ MNIST

MNIST ‚Äî —ç—Ç–æ –Ω–∞–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä—É–∫–æ–ø–∏—Å–Ω—ã—Ö —Ü–∏—Ñ—Ä (–æ—Ç 0 –¥–æ 9).

```python
# –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ (–¥–µ–ª–∏—Ç—Å—è –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏)
(x_train, y_train), (x_test, y_test) = keras.datasets.mnist.load_data()

print("–§–æ—Ä–º–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞:", x_train.shape)
print("–§–æ—Ä–º–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞:", x_test.shape)
```

–û—Ç–ª–∏—á–Ω–æ! –£ —Ç–µ–±—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è –¥–∞—Ç–∞—Å–µ—Ç MNIST. –î–∞–≤–∞–π –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–µ—Ä—ë–º, **—á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ** –∏ **—á—Ç–æ –∑–Ω–∞—á–∞—Ç —ç—Ç–∏ —á–∏—Å–ª–∞**:

---

### üì¶ –ß—Ç–æ —Ç—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–≥—Ä—É–∑–∏–ª?

–¢—ã —Å–∫–∞—á–∞–ª –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö **MNIST** ‚Äî —ç—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –¥–∞—Ç–∞—Å–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è –Ω–∞ –∑–∞–¥–∞—á–µ **—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä—É–∫–æ–ø–∏—Å–Ω—ã—Ö —Ü–∏—Ñ—Ä**.

–°—Å—ã–ª–∫–∞:

```
https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
```

---

### üîç –ß—Ç–æ –≤–Ω—É—Ç—Ä–∏?

–ö–æ–≥–¥–∞ —Ç—ã –≤—ã–ø–æ–ª–Ω–∏–ª:

```python
(x_train, y_train), (x_test, y_test) = keras.datasets.mnist.load_data()
```

–¢—ã –ø–æ–ª—É—á–∏–ª 4 –º–∞—Å—Å–∏–≤–∞:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –°–æ–¥–µ—Ä–∂–∏—Ç                        | –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å       | –û–ø–∏—Å–∞–Ω–∏–µ                            |
| ---------- | ------------------------------- | ----------------- | ----------------------------------- |
| `x_train`  | –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∫–∞—Ä—Ç–∏–Ω–∫–∏)       | `(60000, 28, 28)` | 60 000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (28√ó28 –ø–∏–∫—Å–µ–ª–µ–π) |
| `y_train`  | —Ü–µ–ª–µ–≤—ã–µ –º–µ—Ç–∫–∏ (—Ü–∏—Ñ—Ä—ã –æ—Ç 0 –¥–æ 9) | `(60000,)`        | –ú–µ—Ç–∫–∏ –∫ `x_train`                   |
| `x_test`   | —Ç–µ—Å—Ç–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è            | `(10000, 28, 28)` | 10 000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π                  |
| `y_test`   | –º–µ—Ç–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∞                 | `(10000,)`        | –ú–µ—Ç–∫–∏ –∫ `x_test`                    |

---

### üñºÔ∏è –ß—Ç–æ —Ç–∞–∫–æ–µ `(28, 28)`?

–ö–∞–∂–¥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ MNIST ‚Äî —ç—Ç–æ —á—ë—Ä–Ω–æ-–±–µ–ª–∞—è (–≥—Ä–∞–¥–∞—Ü–∏–∏ —Å–µ—Ä–æ–≥–æ) **–∫–∞—Ä—Ç–∏–Ω–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–º 28 –Ω–∞ 28 –ø–∏–∫—Å–µ–ª–µ–π**. –í—Å–µ–≥–æ –≤ –æ–¥–Ω–æ–º —Ç–∞–∫–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ 784 –ø–∏–∫—Å–µ–ª—è (28 √ó 28).

–ü–∏–∫—Å–µ–ª–∏ –∏–º–µ—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç 0 (—á—ë—Ä–Ω—ã–π) –¥–æ 255 (–±–µ–ª—ã–π), –∏ –º—ã –æ–±—ã—á–Ω–æ **–Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º** –∏—Ö –¥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ 0‚Ä¶1.

---

### üß† –ü–æ—á–µ–º—É 60 000 –∏ 10 000?

* **60 000** –∫–∞—Ä—Ç–∏–Ω–æ–∫ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è **–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏** (`x_train`, `y_train`)
* **10 000** ‚Äî –¥–ª—è **–ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏** –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (`x_test`, `y_test`)

–≠—Ç–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –º–æ–¥–µ–ª—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ **—É—á–∏—Ç—Å—è –æ–±–æ–±—â–∞—Ç—å**, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ ¬´–∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç¬ª –¥–∞–Ω–Ω—ã–µ.

---

### üí° –ü—Ä–∏–º–µ—Ä –æ–¥–Ω–æ–π –∑–∞–ø–∏—Å–∏:

```python
x_train[0].shape   # (28, 28)
y_train[0]         # –Ω–∞–ø—Ä–∏–º–µ—Ä, 5
```

* `x_train[0]` ‚Äî —ç—Ç–æ –º–∞—Å—Å–∏–≤, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–π –ø–∏–∫—Å–µ–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ü–∏—Ñ—Ä—ã.
* `y_train[0]` ‚Äî —ç—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–∏—Ñ—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, "5").





## 3Ô∏è‚É£ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

```python
# –ü–æ–∫–∞–∂–µ–º –ø–µ—Ä–≤—ã–µ 5 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
for i in range(5):
    plt.imshow(x_train[i], cmap='gray')
    plt.title(f"–ú–µ—Ç–∫–∞: {y_train[i]}")
    plt.axis("off")
    plt.show()
```

---

## 4Ô∏è‚É£ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–ù–µ–π—Ä–æ—Å–µ—Ç—å –ª—É—á—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —á–∏—Å–ª–∞–º–∏ –æ—Ç 0 –¥–æ 1, –∞ –Ω–µ –æ—Ç 0 –¥–æ 255, –ø–æ—ç—Ç–æ–º—É **–Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø–∏–∫—Å–µ–ª–∏**.

```python
x_train = x_train / 255.0
x_test = x_test / 255.0
```

---

## 5Ô∏è‚É£ –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

### üîç –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:

* **Flatten:** –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç 28x28 –ø–∏–∫—Å–µ–ª–µ–π –≤ –≤–µ–∫—Ç–æ—Ä –∏–∑ 784 —á–∏—Å–µ–ª.
* **Dense(128):** —Å–∫—Ä—ã—Ç—ã–π —Å–ª–æ–π –∏–∑ 128 –Ω–µ–π—Ä–æ–Ω–æ–≤ —Å ReLU-–∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π.
* **Dropout(0.2):** –≤—ã–∫–ª—é—á–∞–µ—Ç 20% –Ω–µ–π—Ä–æ–Ω–æ–≤ –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è (—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è).
* **Dense(10):** –≤—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π –¥–ª—è 10 –∫–ª–∞—Å—Å–æ–≤ (—Ü–∏—Ñ—Ä—ã 0‚Äì9), softmax-–∞–∫—Ç–∏–≤–∞—Ü–∏—è.

```python
model = keras.Sequential([
    keras.layers.Flatten(input_shape=(28, 28)),     
    keras.layers.Dense(128, activation='relu'),     
    keras.layers.Dropout(0.2),                      
    keras.layers.Dense(10, activation='softmax')    
])
```

---

## 6Ô∏è‚É£ –ö–æ–º–ø–∏–ª—è—Ü–∏—è –º–æ–¥–µ–ª–∏

### üîç –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:

* **optimizer='adam'** ‚Äî —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–±–Ω–æ–≤–ª—è—Ç—å –≤–µ—Å–∞.
* **loss='sparse\_categorical\_crossentropy'** ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –¥–ª—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.
* **metrics=\['accuracy']** ‚Äî –º–µ—Ç—Ä–∏–∫–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã —Ö–æ—Ç–∏–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å.

```python
model.compile(
    optimizer='adam',
    loss='sparse_categorical_crossentropy',
    metrics=['accuracy']
)
```

---

## 7Ô∏è‚É£ –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```python
history = model.fit(x_train, y_train, epochs=5, validation_split=0.1)
```

* `validation_split=0.1` ‚Äî 10% —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ.
* `epochs=5` ‚Äî –ø—Ä–æ–≥–æ–Ω–∏–º –º–æ–¥–µ–ª—å 5 —Ä–∞–∑ –ø–æ –≤—Å–µ–º –¥–∞–Ω–Ω—ã–º.

---

## 8Ô∏è‚É£ –û—Ü–µ–Ω–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ

```python
test_loss, test_acc = model.evaluate(x_test, y_test)
print(f"–¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ: {test_acc:.4f}")
```

---

## 9Ô∏è‚É£ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –æ–±—É—á–µ–Ω–∏—è

```python
# Accuracy
plt.plot(history.history['accuracy'], label='–¢–æ—á–Ω–æ—Å—Ç—å (train)')
plt.plot(history.history['val_accuracy'], label='–¢–æ—á–Ω–æ—Å—Ç—å (val)')
plt.xlabel('–≠–ø–æ—Ö–∞')
plt.ylabel('–¢–æ—á–Ω–æ—Å—Ç—å')
plt.title('–¢–æ—á–Ω–æ—Å—Ç—å –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è')
plt.legend()
plt.grid(True)
plt.show()
```

---

## üîü –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

```python
predictions = model.predict(x_test)

for i in range(5):
    plt.imshow(x_test[i], cmap="gray")
    plt.title(f"–ò—Å—Ç–∏–Ω–Ω–∞—è –º–µ—Ç–∫–∞: {y_test[i]}, –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–æ: {np.argmax(predictions[i])}")
    plt.axis("off")
    plt.show()
```

---

## üìö –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ:

1. –ò–∑–º–µ–Ω–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–π—Ä–æ–Ω–æ–≤ –≤ —Å–∫—Ä—ã—Ç–æ–º —Å–ª–æ–µ (`Dense(64)`, `256`, `512`) ‚Äî –∫–∞–∫ —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å?
2. –î–æ–±–∞–≤—å—Ç–µ –≤—Ç–æ—Ä–æ–π —Å–∫—Ä—ã—Ç—ã–π —Å–ª–æ–π –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.
3. –£–≤–µ–ª–∏—á—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö –¥–æ 10 –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ª–∏ **–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ**.
4. –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫ **–ø–æ—Ç–µ—Ä—å (`loss`)**, –∫–∞–∫ –º—ã —Å–¥–µ–ª–∞–ª–∏ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é.
5. –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Å–≤–æ–∏—Ö —Ü–∏—Ñ—Ä (–º–æ–∂–Ω–æ –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å –≤ Paint, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å, –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏ –ø–æ–¥–∞—Ç—å –Ω–∞ –≤—Ö–æ–¥).

---

## üéÅ –•–æ—á–µ—à—å –≥–æ—Ç–æ–≤—ã–π Google Colab?

–í–æ—Ç Colab-—Å—Å—ã–ª–∫–∞ –Ω–∞ –≥–æ—Ç–æ–≤—ã–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –±–ª–æ–∫–Ω–æ—Ç (—Å–æ–¥–µ—Ä–∂–∏—Ç –≤–µ—Å—å –∫–æ–¥ –≤—ã—à–µ):
üìé [**–û—Ç–∫—Ä—ã—Ç—å –≤ Google Colab**](https://colab.research.google.com/drive/1-ZHtRo-Xl4bD7Zn__wKTc-jAs9PSk8Lt?usp=sharing)

(–ï—Å–ª–∏ —Ç–µ–±–µ –Ω—É–∂–Ω–æ ‚Äî —è –º–æ–≥—É –∑–∞–≥—Ä—É–∑–∏—Ç—å `.ipynb` —Ñ–∞–π–ª –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π Colab —Å —Ç–≤–æ–∏–º —Ç–æ–∫–µ–Ω–æ–º Keras + FastAPI).
